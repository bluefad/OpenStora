<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from www.openstora.com/wiki/index.php?title=Using_A_Serial_Connection by HTTrack Website Copier/3.x [XR&CO'2013], Wed, 22 Jan 2014 07:53:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<title>Using A Serial Connection - OpenStora</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.18.1" />
<link rel="shortcut icon" href="http://www.openstora.com/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="OpenStora (en)" />
<link rel="EditURI" type="application/rsd+xml" href="api251f.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="OpenStora Atom feed" href="index890f.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="load5c1d.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/wiki/skins/monobook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/wiki/skins/monobook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: hardwar6_wiki:resourceloader:filter:minify-css:4:c88e2bcd56513749bec09a7e29cb3ffa */
</style>
<script src="load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
	mw.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "Using_A_Serial_Connection", "wgTitle": "Using A Serial Connection", "wgCurRevisionId": 799, "wgArticleId": 46, "wgIsArticle": true, "wgAction": "view", "wgUserName": null, "wgUserGroups": ["*"], "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script><script>if(window.mw){
	mw.loader.load(["mediawiki.page.startup"]);
}
</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Using_A_Serial_Connection action-view skin-monobook">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">Using A Serial Connection</h1>
	<div id="bodyContent">
		<div id="siteSub">From OpenStora</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
		<!-- start content -->
<div lang="en" dir="ltr" class="mw-content-ltr"><p>Updated 2nd August 2010: This is a work in progress, I am using this to record my progress with the Stora, and hopefully others will find this useful. If you brick your device then it is not my fault.
</p><p>Background/Objective
The stora is the latest in a line of embedded-type devices that I have stuck debian/emdebian on:
</p><p>Linksys NSLU2
Netgear WGT634U
PCEngines Alix 3c
O2 Joggler
</p><p>The Stora is the first of the list that can have large amounts of internal storage. I want to run as close to native debian as possible. I use Debian except where absolutely have to use something else. The instructions will assume you do the same.
</p><p><br />
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Purchase_Stora"><span class="tocnumber">1</span> <span class="toctext">Purchase Stora</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Serial_port"><span class="tocnumber">2</span> <span class="toctext">Serial port</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Accessing_uBoot"><span class="tocnumber">3</span> <span class="toctext">Accessing uBoot</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Preparing_the_emdebian.2Fdebian_file_system"><span class="tocnumber">4</span> <span class="toctext">Preparing the emdebian/debian file system</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Stick_the_kernel_somewhere"><span class="tocnumber">5</span> <span class="toctext">Stick the kernel somewhere</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Purchase_Stora"> Purchase Stora </span></h2>
<p>A little while ago eBuyer were selling a 500GB Stora for £70 inc postage.
</p>
<h2> <span class="mw-headline" id="Serial_port"> Serial port </span></h2>
<p><b> CAUTION: If you do not use this specific cable, </b>
</p><p><b> you need to make sure your cable is a LVTTL or </b>
</p><p><b> TTL level cable. A standard RS232 cable will </b>
</p><p><b> fry the Stora's main board.</b>
</p><p><br />
I purchased a nokia dku-5 for £2.98 including postage.
<a rel="nofollow" class="external free" href="http://www.amazon.co.uk/gp/product/B00007BHPL">http://www.amazon.co.uk/gp/product/B00007BHPL</a>
And a 4 pin header plug from e-bay.
<a rel="nofollow" class="external free" href="http://cgi.ebay.co.uk/ws/eBayISAPI.dll?ViewItem&amp;item=140376266229">http://cgi.ebay.co.uk/ws/eBayISAPI.dll?ViewItem&amp;item=140376266229</a>
</p><p>The DKU-5 is a serial to USB converter, which accepts the right voltages etc. I generally use a max232 converter, but as virtually nothing has a serial port these days, this is a neater solution.
</p><p>Cut the proprietary Nokia connector off the end. Find that (contrary to internet sources) the cable has 3 cables. These are (from memory, will check):
</p>
<ol><li>Orange: Ground (pin nearest battery on stora)
</li><li>Red:    TX (next pin to Orange)
</li><li>Blue:   RX (next pin to red)
</li></ol>
<p>If you use the crimps from the kit off e-bay, and stick them straight on the pins with some insulating tape to prevent shorts, then by bending the crimps slightly, you can get the back cover on. The cable can be threaded out of the case near the feet at the bottom, no external drilling etc necessary- nice!
</p><p>A DKU-5 bought in Australia had white (ground), black (TX), and red (RX) wires.  Mis-wiring the white ground to +ve pin (4th pin) did not harm the board (phew).
</p>
<h2> <span class="mw-headline" id="Accessing_uBoot"> Accessing uBoot </span></h2>
<p>Connect the USB connector to a machine of your choosing. Using 'dmesg' should show you which /dev/ttyUSB&lt;x&gt; the device has connected to. I used minicom or screen to connect to the port at '115200,8,N,1'.
</p><p>Start the stora. You should see the boot messages, when it says 'Press a key to interrupt autostart', press a key!
</p><p>Various parameters need to be set, these ones can be/need to be saved.
setenv serverip &lt;ip of tftp server&gt;
setenv ipaddr &lt;ip of stora&gt;
setenv mainlineLinux yes
setenv arcNumber 2734
saveenv
reset
</p>
<h2> <span class="mw-headline" id="Preparing_the_emdebian.2Fdebian_file_system"> Preparing the emdebian/debian file system </span></h2>
<p>I couldn't be bothered using NFS and all that, my plan is to just boot a kernel from tftp and use a local filesystem.
Get the emdebian root file system, and unpack it onto a SATA disk, with ext3 (if you want you can have a swap-partition.
You'll need to modify the following files(on the unpacked file system):
</p><p>/etc/fstab
comment out the root file system and replace it with the partition with the unpacked file-system, on mine it was /dev/sdb2 (I left the original disk in place, and the swap was the first partition) so the line looked like:
</p><p><code>/dev/sdb2       /           ext3    defaults          1       1</code>
</p><p>/etc/inittab
The inittab file was not configured correctly to put a console/terminal on the serial port, so this needs to be modified. Find the lines that look like the below, and make them exactly like it!
</p><p><code># Example how to put a getty on a serial line (for a terminal)</code>
</p><p><code>#</code>
</p><p><code>T0:23:respawn:/sbin/getty -L ttyS0 115200,9600 vt100</code>
</p><p><code>#T1:23:respawn:/sbin/getty -L ttyS1 9600 vt100</code>
</p><p><br />
You can also comment out the 7 getty lines above, AFAIK they will do exactly nothing on a machine without a keyboard mouse etc.
</p><p>I also edited /etc/network/interfaces, so the interface uses DHCP. A static would probably be a good idea, this was just easier. You will need to change the IP. I haven't found the need to add the MAC address.
</p><p>If you can chroot into the image, you can set the root passwd. Otherwise put an ssh key in place.
</p>
<h2> <span class="mw-headline" id="Stick_the_kernel_somewhere"> Stick the kernel somewhere </span></h2>
<p>On a machine on your local LAN configure your tftpd server (apt-get install atftpd)
Copy the uImage.mainline out of the repository, into /var/lib/tftpboot/
</p><p>Step 4: Stick the drive in the machine, start it, and access uBoot
</p><p>to load the kernel off of the tftp server:
</p><p>tftpboot 0x800000 uImage.mainline
</p><p>setenv bootargs $(console) root=/dev/sdb2
</p><p>bootm 0x800000
</p><p>et voila!!
</p><p>Next: Trying to boot the debian kirkwood kernel.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 19/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key hardwar6_wiki:pcache:idhash:46-0!*!*!!en!*!* and timestamp 20140121184933 -->
</div><div class="printfooter">
Retrieved from "<a href="indexeae0.html?title=Using_A_Serial_Connection&amp;oldid=799">http://www.openstora.com/wiki/index.php?title=Using_A_Serial_Connection&amp;oldid=799</a>"</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="indexeb13.html?title=Using_A_Serial_Connection" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="indexc99d.html?title=Talk:Using_A_Serial_Connection&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="index6a56.html?title=Using_A_Serial_Connection&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="indexe979.html?title=Using_A_Serial_Connection&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>

<!-- SSO MOD -->
<a href="http://www.openstora.com/phpBB3/ucp.php?mode=login" title="Login" accesskey="l">Login</a>
                 / <a href="http://www.openstora.com/phpBB3/ucp.php?mode=register">Register</a>
<!-- END SSO MOD -->

<!-- 				<li id="pt-anonuserpage"><a href="/wiki/index.php?title=User:112.2.37.23" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">112.2.37.23</a></li>
				<li id="pt-anontalk"><a href="/wiki/index.php?title=User_talk:112.2.37.23" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li>
				<li id="pt-anonlogin"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Using+A+Serial+Connection" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
-->
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a title="Visit the main page" style="background-image: url(images/logo.png);" href="index4875.html?title=Main_Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-Website">
		<h5>Website</h5>
		<div class='pBody'>
			<ul>
				<li id="n-HHU-Home"><a href="http://www.hardwarehackersunite.com/" rel="nofollow">HHU Home</a></li>
				<li id="n-HHU-Forum"><a href="http://www.hardwarehackersunite.com/phpBB3" rel="nofollow">HHU Forum</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-Wiki">
		<h5>Wiki</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Main-Page"><a href="index4875.html?title=Main_Page">Main Page</a></li>
				<li id="n-Recent-changes"><a href="indexa414.html?title=Special:Recentchanges" rel="nofollow">Recent changes</a></li>
				<li id="n-Help"><a href="index4c21.html?title=Help">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://www.openstora.com/wiki/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search OpenStora [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="index8f43.html?title=Special:WhatLinksHere/Using_A_Serial_Connection" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="index33c3.html?title=Special:RecentChangesLinked/Using_A_Serial_Connection" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
				<li id="t-specialpages"><a href="indexc7ac.html?title=Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
				<li><a href="index6d0d.html?title=Using_A_Serial_Connection&amp;printable=yes" rel="alternate">Printable version</a></li>
				<li id="t-permalink"><a href="indexeae0.html?title=Using_A_Serial_Connection&amp;oldid=799" title="Permanent link to this revision of the page">Permanent link</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 18 June 2011, at 04:47.</li>
		<li id="viewcount">This page has been accessed 7,821 times.</li>
		<li id="privacy"><a href="indexa914.html?title=OpenStora:Privacy_policy" title="OpenStora:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="index9a54.html?title=OpenStora:About" title="OpenStora:About">About OpenStora</a></li>
		<li id="disclaimer"><a href="index640c.html?title=OpenStora:General_disclaimer" title="OpenStora:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
	mw.loader.load(["mediawiki.user", "mediawiki.util", "mediawiki.page.ready", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
}
</script>
<script>if(window.mw){
	mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,
	"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mw.user.tokens.set({"editToken":"+\\","watchToken":false});;mw.loader.state({"user.options":"ready","user.tokens":"ready"});
	
	/* cache key: hardwar6_wiki:resourceloader:filter:minify-js:4:99acc2c3ab516bb21085c70c2195f3df */
}
</script><!-- Served in 0.299 secs. --></body>
<!-- Mirrored from www.openstora.com/wiki/index.php?title=Using_A_Serial_Connection by HTTrack Website Copier/3.x [XR&CO'2013], Wed, 22 Jan 2014 07:53:54 GMT -->
</html>